{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the ScriptScribbler application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "username": {
          "type": "string",
          "description": "Username of the user."
        },
        "displayName": {
          "type": "string",
          "description": "Display name of the user."
        }
      },
      "required": [
        "id",
        "email",
        "username",
        "displayName"
      ]
    },
    "Script": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Script",
      "type": "object",
      "description": "Represents a screenplay script, including its content.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the script."
        },
        "title": {
          "type": "string",
          "description": "Title of the script."
        },
        "logline": {
            "type": "string",
            "description": "A one-sentence summary of the script."
        },
        "content": {
          "type": "string",
          "description": "The full content of the screenplay."
        },
        "authorId": {
          "type": "string",
          "description": "Reference to the User who created the script."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the script was created.",
          "format": "date-time"
        },
        "lastModified": {
          "type": "string",
          "description": "Timestamp indicating when the script was last modified.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "title",
        "content",
        "authorId",
        "createdAt",
        "lastModified"
      ]
    },
    "Note": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Note",
      "type": "object",
      "description": "Represents a note associated with a script.",
      "properties": {
        "id": { "type": "string" },
        "title": { "type": "string" },
        "content": { "type": "string" },
        "category": { "type": "string" },
        "imageUrl": { "type": "string", "format": "uri" }
      },
      "required": ["id", "title", "content", "category"]
    },
    "Character": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Character",
      "type": "object",
      "description": "Represents a character in a screenplay.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the character."
        },
        "name": {
          "type": "string",
          "description": "Name of the character."
        },
        "description": {
          "type": "string",
          "description": "A short, one-line description of the character."
        },
        "profile": {
            "type": "string",
            "description": "A detailed profile of the character, including backstory, personality, motivations, etc."
        },
        "imageUrl": {
            "type": "string",
            "description": "URL for the character's portrait image."
        },
        "scenes": {
            "type": "number",
            "description": "The number of scenes the character appears in."
        },
        "createdAt": {
            "type": "string",
            "format": "date-time"
        },
        "updatedAt": {
            "type": "string",
            "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "scenes"
      ]
    },
    "Scene": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Scene",
      "type": "object",
      "description": "Represents a single scene in a screenplay.",
      "properties": {
        "id": { "type": "string" },
        "sceneNumber": { "type": "number" },
        "setting": { "type": "string" },
        "description": { "type": "string" },
        "time": { "type": "number", "description": "Estimated time in minutes." }
      },
      "required": ["id", "sceneNumber", "setting", "description", "time"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/entities/User"
          },
          "description": "Stores user profiles."
        }
      },
      {
        "path": "/users/{userId}/scripts/{scriptId}",
        "definition": {
            "entityName": "Script",
            "schema": { "$ref": "#/entities/Script" },
            "description": "Stores screenplay documents owned by a user."
        }
      },
      {
        "path": "/users/{userId}/scripts/{scriptId}/characters/{characterId}",
        "definition": {
          "entityName": "Character",
          "schema": {
            "$ref": "#/entities/Character"
          },
          "description": "Stores characters for a specific script."
        }
      },
      {
        "path": "/users/{userId}/scripts/{scriptId}/notes/{noteId}",
        "definition": {
          "entityName": "Note",
          "schema": {
            "$ref": "#/entities/Note"
          },
          "description": "Stores notes for a specific script."
        }
      },
       {
        "path": "/users/{userId}/scripts/{scriptId}/scenes/{sceneId}",
        "definition": {
          "entityName": "Scene",
          "schema": {
            "$ref": "#/entities/Scene"
          },
          "description": "Stores scenes for a specific script."
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to be script-centric. Each user has a collection of scripts. All related data, such as characters, notes, and scenes are stored in subcollections under a specific script document. This ensures data is well-organized and allows for clear, path-based security rules where a user can only access their own scripts and the data within them."
  }
}
